<div class="p-12 h-full" (contextmenu)="contextMenuBackground($event)">
  <div class="tabs tabs-lift pb-4">
    <ng-container *ngFor="let window of windows">
      <a
        class="tab"
        (click)="clickWindow($event, window)"
        (dblclick)="doublClickWindow($event, window)"
        (contextmenu)="contextMenuWindow($event, window)"
        [class.tab-active]="window.focused"
        [class.indicator]="window.focused"
        >{{ window.title
        }}<span class="indicator-item badge" *ngIf="window.focused">{{
          window.tabsCount
        }}</span></a
      >
      <div class="tab-content bg-base-100 border-base-300 p-4">
        <ng-container *ngFor="let tabGroup of window.tabGroups">
          <div
            class="items-center text-center rounded-lg transition-all shadow-sm hover:scale-105 cursor-pointer bg-base-200 indicator w-30 p-1 m-1"
            (click)="clickTabGroup($event, tabGroup)"
            (contextmenu)="contextMenuTabGroup($event, tabGroup)"
            [class]="'bg-' + tabGroup.color + '-200'"
          >
            <span class="indicator-item badge badge-soft badge-grey">{{
              tabGroup.tabs?.length
            }}</span>
            <p class="text-xs mt-2 truncate w-full">{{ tabGroup.title }}</p>
          </div>
        </ng-container>
        <ng-container *ngFor="let tab of window.tabs">
          <div
            class="items-center text-center rounded-lg transition-all shadow-sm hover:scale-105 cursor-pointer bg-base-200 indicator w-30 p-1 m-1"
            (click)="clickTab($event, tab)"
            (contextmenu)="contextMenuTab($event, tab)"
          >
            <p class="text-xs mt-2 truncate w-full">{{ tab.title }}</p>
          </div>
        </ng-container>
      </div>
    </ng-container>
  </div>

  <div class="breadcrumbs text-sm" *ngIf="breadcrumb!.length > 1">
    <ul>
      <li *ngFor="let crumb of breadcrumb; let first = first; let last = last">
        <a
          *ngIf="!last"
          (click)="navigateToCrumb(crumb)"
          (dragover)="dragOverBookmark($event, crumb)"
          (dragleave)="dragLeaveBookmark($event, crumb)"
          (drop)="dropBookmark($event, crumb)"
          class="cursor-pointer"
          [class.ring-2]="
            dropHoveredBookmark === crumb && crumb.type === 'bookmarkFolder'
          "
          [class.cursor-not-allowed]="
            dropHoveredBookmark === crumb && crumb.type === 'bookmark'
          "
        >
          <span class="inline-block w-4 h-4 mr-1" *ngIf="first">
            <ng-icon name="heroHome" class="w-4 h-4" />
          </span>
          {{ crumb.title }}
        </a>
        <a *ngIf="last" class="font-bold cursor-not-allowed">
          {{ crumb.title }}
        </a>
      </li>
    </ul>
  </div>

  <div
    class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 lg:grid-cols-7 gap-4"
    [ngStyle]="{
      'grid-template-columns': 'repeat(' + columns + ', minmax(0, 1fr))',
    }"
    *ngIf="currentFolder"
  >
    <ng-container
      *ngFor="let bookmark of currentFolder.children; trackBy: trackById"
    >
      <a
        *ngIf="!bookmark.deleted"
        class="rounded-2xl shadow hover:shadow-xl hover:scale-101 transition p-4 flex items-center space-x-4 cursor-pointer tooltip"
        [ngClass]="{
          'ring-2':
            dropHoveredBookmark === bookmark &&
            bookmark.type === 'bookmarkFolder',
          'scale-105':
            dropHoveredBookmark === bookmark &&
            bookmark.type === 'bookmarkFolder',
        }"
        [href]="bookmark.url"
        (click)="clickBookmark($event, bookmark)"
        (contextmenu)="contextMenuBookmark($event, bookmark)"
        (dragstart)="dragBookmark($event, bookmark)"
        (dragover)="dragOverBookmark($event, bookmark)"
        (dragleave)="dragLeaveBookmark($event, bookmark)"
        (drop)="dropBookmark($event, bookmark)"
      >
        <div
          class="tooltip-content"
          *ngIf="bookmark.title && dragSelectedBookmark !== bookmark"
        >
          <div class="text-sm">
            {{ bookmark.title }}
          </div>
        </div>
        <img
          [src]="bookmark.favIconUrl"
          class="w-10 rounded-md mask mask-squircle"
        />
        <span class="truncate max-w-[150px] text-sm font-medium">
          {{ bookmark.title }}
        </span>
      </a>
    </ng-container>
  </div>
</div>
<app-modal-host />
<app-toast-container />
